## 依存パッケージの管理

### package.jsonの作成

package.jsonの作成コマンド。質問にいくつか回答するとpackage.jsonが作成される

```
npm init
```

installコマンドを実行する際に`--save`もしくは`-S`オプションを付けることでダウンロードした時点のパッケージのバージョンをpackage.jsonに追記できる

```
npm intall -S lodash
```

インストールするバージョンを指定する場合は`@4.2`のように記述する

```
npm install -S lodash@4.2
```

### 開発時のみに必要なパッケージの記述
`--save`オプションではdependenciesプロパティに依存パッケージが記述されているが、他にも依存パッケージの記述方法がある。

devDependenciesは開発時に必要な依存パッケージを記述するプロパティ。
アプリケーションのライブラリとして依存するパッケージはdependenciesに記述し、アプリケーションのビルドやテストに使うパッケージなど、実行に必要ないものはdevDependenciesに記述される。
`--save-dev`や`-D`をつけてinstallする

```
npm install -D gulp
```

devDependenciesに記述された依存関係はそのパッケージが別のパッケージから依存されるときには解決されないためライブラリとして利用される際の依存関係を最小に抑えられる。

### 依存パッケージをインストールする
依存パッケージをすべてインストールするにはpackage.jsonのあるディレクトリで引数を与えずにinstallを実行する

### 依存パッケージをアップデートする
package.jsonに記述されたパッケージの新しいバージョンがリリースされた時にはupdateコマンドでアップデートできる。

```
npm update --save lodash
```

`--save-dev`オプションで任意のバージョンにアップデートすることもできる

### 依存パッケージのバージョンを固定する
npmのinstallコマンドではpackage.jsonに記述されたバージョン指定にしたがってパッケージをダウンロードする。
指定したバージョンが^などで曖昧にされている場合、同じpackage.jsonでもinstallコマンドを実行した場合、同じバージョンがインストールされる保証は無い。

実際にダウンロードされているバージョンを保存し、保存時の依存関係を完全に復元するためのしくみがある。

```
npm shrinkwrap
```

`install`するとき`npm-shrinkwrap.json`があるとしていされているバージョンでダウンロードされる。

依存パッケージをアップデートしたあとにうまく動作しないことがあっても`npm-shrinkwrap.json`の変更を元に戻して依存パッケージを再インストールすることで復元できる。

## npmからさまざまなスクリプトを実行する

### startコマンドで開発用サーバを立ち上げる
startコマンドは主にアプリケーションやプログラムの起動を行うために使われる。

### run-scriptで独自のコマンドを実行する
npmでは開発者自身でコマンドを定義できる。
独自定義のコマンドを実行するには`run-script`や`run`コマンド。
この2つのコマンドはpackage.jsonのscriptsプロパティに定義されたコマンドの名前を指定して実行する。

scriptsプロパティに定義されている一覧を見るには引数を与えずに`run`を実行する

```
npm run
```

`run-script`からNode.jsを実行できるので、複雑なタスクであればNode.jsでスクリプトを記述しておき、それを実行できる。

## タスクランナーを使う

### Gulp
タスクランナー
多くのファイルを処理するタスクや多段階の処理を行うタスクを記述することに長けている

#### タスクの定義
Gulpを使うにはさまざまなタスクをNode.jsのスクリプトで定義したgulp.jsが必要。

#### タスクの実行
実行コマンド
```
gulp build
```

## ユニットテストを書く
### Node.jsでテストを書く

#### テストの記述
2つの値を比較して一致しているかを確認する`assert.strictEqual`

#### テストの実行
`npm test`

### テスティングフレームワークを使用する
標準のassertだけでなくテスティングフレームワークを使用することで、テスト結果をリッチに出力したり複数のテストを同時に実行したりできる

#### Mochaを使ったテストの記述
Mochaではテストのグループを`describe関数`や`it関数`で表現する。
クラスやファイル、関数ごとにdescribe関数で入れ子のグループを作り、関数にある入力を与えた時にどのような出力、結果が期待されるのかを書いていく。

#### Mochaのインストール

```
npm install -S Mocha
```

mochaコマンドはデフォルトでtestディレクトリ直下にあるJavaScriptファイルを全て実行する。
test直下以外のディレクトリを実行するときは`mocha someDir`のように引数で指定できる。
ただし、対象直下以外のディレクトリは実行されないのでindexSpec.jsの中で実行したいファイルをrequireする。
